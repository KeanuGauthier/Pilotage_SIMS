import json
import requests

API_URL = "https://api.wimi.pro"  # adapte si ton intranet a un endpoint different
EMAIL = "ton.email@domaine.com"
PASSWORD = "ton_mot_de_passe"
API_KEY = "ta_cle_api"

def wimi_call(target: str, identification: dict) -> requests.Response:
    wapi_msg = {"header": {"target": target, "identification": identification}}
    return requests.post(
        API_URL,
        headers={
            "X-Wimi-WApi": json.dumps(wapi_msg),
            "Accept": "application/json",
            "Content-Type": "application/json",
        },
        data="{}",
        timeout=30,
        verify=True,
    )

identification = {
    "email": EMAIL,
    "password": PASSWORD,
    "apiKey": API_KEY,
}

for target in ["auth.user.Login", "auth.user.login"]:
    r = wimi_call(target, identification)
    print("target =", target)
    print("HTTP  =", r.status_code)
    print(r.text)
    print("-" * 40)